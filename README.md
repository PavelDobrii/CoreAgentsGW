# CoreAgents City Guide

Добро пожаловать в монорепозиторий CoreAgents. Основной сервис находится в
директории [`city_guide`](city_guide/README.md). В этом файле собраны быстрые
ссылки и чек-лист по подготовке рабочего окружения.

## Быстрый старт

1. Убедитесь, что в WSL установлен Python 3.10+ и актуальный `pip`.
2. Перейдите в папку `city_guide` и установите зависимости из `.meta/packages`:
   ```bash
   cd city_guide
   python -m pip install --upgrade pip
   python -m pip install -r ../.meta/packages
   ```
   > Обязательно проверьте, что `uvicorn` действительно установился: без него
   > `python -m city_guide.app.debug` завершится с ошибкой импорта и сервис не
   > запустится.
3. Скопируйте файл окружения и подберите значения под себя:
   ```bash
   cp .env.example .env
   ```
   > Если предпочитаете хранить настройки в корне репозитория, создайте там
   > `.env` — приложение найдёт его автоматически.
4. Для запуска сервиса в отладке используйте конфигурацию `Python` с модулем
   `city_guide.app.debug` или выполните `python -m city_guide.app.debug`.

Подробные инструкции по настройке PyCharm, работе с базой данных и внешними
сервисами описаны в [README приложения](city_guide/README.md).

## Совместный запуск фронта и бэка

1. **Бэкенд** — из директории `city_guide` установите зависимости (см. выше) и
   запустите FastAPI через uvicorn:
   ```bash
   cd city_guide
   uvicorn city_guide.app.main:app --reload --host 0.0.0.0 --port 8000
   ```
   Сервис будет доступен по адресу http://localhost:8000, все REST-эндпоинты
   опубликованы под префиксом `/v1`.
2. **Фронтенд** — из `frontend-main/frontend-main` установите Node-зависимости и
   поднимите dev-сервер Vite:
   ```bash
   cd frontend-main/frontend-main
   npm install
   echo "VITE_API_URL=http://localhost:8000/v1/" > .env.local
   npm run dev
   ```
   Значение `VITE_API_URL` обязано указывать на `/v1/`, чтобы `apiClient`
   формировал корректные пути (`routes`, `profile`, `places`, `login` и т.д.).

### Минимальные ручные сценарии

После запуска обоих сервисов откройте фронтенд по адресу, который напечатает
Vite (обычно http://localhost:5173) и последовательно выполните проверочные
шаги:

1. **Регистрация и авторизация** — пройдите форму Sign Up, убедитесь что после
   `POST /v1/register` пользователь автоматически залогинен, а профиль грузится
   через `GET /v1/profile`.
2. **Обновление профиля** — измените город/язык/интересы на странице профиля и
   сохраните. Фронт отправит `PUT /v1/profile`, а страница должна показать
   обновлённые данные.
3. **Поиск мест** — откройте форму поиска (Places) и выполните запрос. В ответе
   `GET /v1/places` должны прийти координаты и названия точек.
4. **Работа с маршрутами** — создайте маршрут (форма Trip). После `POST
   /v1/routes` обновите список (`GET /v1/routes`) и убедитесь, что карточка
   ведёт на детальную страницу (`GET /v1/routes/{id}`).
5. **Генерация маршрута** — на детальной странице нажмите Generate. Это вызовет
   `POST /v1/routes/{id}/generate` и после завершения обновит таймлайн точек.

Эти действия проверяют, что фронт без изменений взаимодействует с локальным
FastAPI-бэкендом из этого репозитория.
